model Marcacion {
  id        Int       @id @default(autoincrement())
  usuario   Usuario   @relation(fields: [usuarioId], references: [id])
  usuarioId Int
  tipo      PunchType
  at        DateTime  @default(now()) // instante UTC
  ip        String?   @db.VarChar(64)
  userAgent String?
  note      String?
  lat       Decimal?  @db.Decimal(9, 6)
  lng       Decimal?  @db.Decimal(9, 6)
  createdAt DateTime  @default(now())

  @@index([usuarioId, at])
  @@map("marcaciones")
}

enum EvidenciaTipo {
  SCREENSHOT
  RECORDING
}

model Evidencia {
  id          Int        @id @default(autoincrement())
  usuarioId   Int
  url         String
  publicId    String
  resource    String
  bytes       Int?
  kind        EvidenciaTipo
  marcacionId Int?
  note        String?
  ip          String?    @db.VarChar(64)
  userAgent   String?
  createdAt   DateTime   @default(now())

  usuario     Usuario    @relation(fields: [usuarioId], references: [id])
  marcacion   Marcacion? @relation(fields: [marcacionId], references: [id])

  @@index([usuarioId, createdAt])
  @@map("evidencias")
}
